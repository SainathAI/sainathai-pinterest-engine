name: Deploy Pinterest Engine (Minimal)
on:
  workflow_dispatch:

permissions:
  contents: write
  pull-requests: write

jobs:
  deploy:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Configure Git
        run: |
          git config user.name "sainathai-bot"
          git config user.email "noreply@sainathaibot.local"

      - name: Create folders and placeholder files
        run: |
          mkdir -p n8n/workflows
          mkdir -p playwright
          mkdir -p ollama/prompts
          mkdir -p pinterest/api

          touch n8n/workflows/rotation-scheduler.json
          touch n8n/workflows/content-generator.json
          touch n8n/workflows/canva-builder.json
          touch n8n/workflows/export-monitor.json
          touch n8n/workflows/pinterest-poster.json
          touch n8n/workflows/analytics-engine.json

          touch playwright/package.json
          touch playwright/render_canva.js

          touch ollama/prompts/ai-tools.txt
          touch ollama/prompts/productivity.txt
          touch ollama/prompts/digital-marketing.txt
          touch ollama/prompts/mmo.txt

          touch pinterest/api/post-pin.js

      - name: Commit changes
        run: |
          git add -A
          git commit -m "Minimal deploy: placeholder files" || echo "No changes"

      - name: Create Pull Request
        uses: peter-evans/create-pull-request@v5
        with:
          token: ${{ secrets.GH_PAT }}
          commit-message: "Minimal deploy: placeholder files"
          branch: deploy-engine-min-${{ github.run_id }}
          title: "Deploy Engine (Minimal Placeholder Structure)"
          body: |
            This PR sets up the base folder and file scaffolding.
            Next PR will inject full engine logic.
          base: main
